// 卡片样式
@use '../base/variables' as *;
@use '../base/mixins' as mix;
@use '../base/responsive' as resp;
@use '../base/responsive-patterns' as pattern;

// --- 通用卡片类型 ---

// 通用卡片基础样式
// 所有卡片类型的基础样式
@mixin card-base {
  box-shadow: $box-shadow;
  border: none;
  border-radius: $border-radius-lg;
  overflow: hidden; // 重要，用于图片等子元素
  animation: fadeIn $animation-duration-slow ease-out;
}

// 内容卡片基础样式
// 用于文章、项目等内容列表
@mixin content-card-base {
  @include card-base;
  border-radius: $border-radius-xl;
  margin-bottom: 1.5rem; // 卡片之间的间距

  .card-img-top {
    height: 180px;
    object-fit: cover;
  }

  .card-body {
    padding: 1.25rem;
  }

  .card-title {
    font-weight: $font-weight-bold;
    margin-bottom: 0.75rem;
  }

  .card-footer {
    padding: 1rem 1.25rem;
    background: transparent;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
  }
}

// 特色卡片基础样式
// 用于特色内容展示
@mixin feature-card-base {
  @include card-base;
  height: 100%; // 确保在网格中高度一致
  display: flex;
  flex-direction: column;
  border-radius: $border-radius-xl;

  .card-img-top {
    height: 200px;
    object-fit: cover;
  }

  .card-body {
    flex: 1; // 确保主体占据剩余空间
  }

  .card-title {
    font-weight: $font-weight-bold;
    color: $dark;
    margin-bottom: 1rem;
  }
}

// --- Mixins for Card Optimizations ---

// Mixin for common card hover effect (translateY + box-shadow)
// 提供三种悬停效果强度：subtle（微妙）、moderate（适中）、strong（强烈）
@mixin card-hover-effect($intensity: 'subtle', $custom-y-translate: null, $custom-shadow: null) {
  transition: transform $transition-base, box-shadow $transition-base;
  will-change: transform, box-shadow; // Optimize animation performance

  @if $intensity == 'subtle' {
    // 微妙效果：仅增强阴影，几乎不移动
    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }
  } @else if $intensity == 'moderate' {
    // 适中效果：适度上移和阴影
    &:hover {
      transform: translateY(-5px);
      box-shadow: $box-shadow-lg;
    }
  } @else if $intensity == 'strong' {
    // 强烈效果：明显上移和强阴影
    &:hover {
      transform: translateY(-10px);
      box-shadow: $box-shadow-xl;
    }
  } @else if $custom-y-translate != null and $custom-shadow != null {
    // 自定义效果
    &:hover {
      transform: translateY($custom-y-translate);
      box-shadow: $custom-shadow;
    }
  } @else {
    // 默认效果（向后兼容）
    &:hover {
      transform: translateY(-3px);
      box-shadow: $box-shadow;
    }
  }
}

// Mixin for common image scale hover effect
@mixin image-scale-hover($scale: 1.05, $duration: 0.8s) {
  .card-img-top {
    transition: transform $duration ease;
    will-change: transform;
  }
  &:hover .card-img-top {
    transform: scale($scale);
  }
}

// --- 基础卡片样式 ---
.card {
  // 基础卡片样式
  box-shadow: $box-shadow;
  border: none;
  border-radius: $border-radius-lg;
  overflow: hidden; // 重要，用于图片等子元素
  animation: fadeIn $animation-duration-slow ease-out;
  @include card-hover-effect('subtle'); // 使用微妙悬停效果
}

// 卡片头部
.card-header {
  // 卡片头部样式
  border-bottom: none; // Remove default Bootstrap border
  padding: 1.25rem 1.5rem;
}

// 卡片内容
.card-body {
  // 卡片主体内容区域
  padding: 1.5rem;
}

// 卡片底部
.card-footer {
  // 卡片底部样式
  background: transparent; // Often used for meta info or actions
  border-top: 1px solid rgba(0, 0, 0, 0.05); // Subtle separator
  padding: 1rem 1.25rem;
}

// --- Specific Card Variations ---

// 功能图标卡片 (通常用于展示服务或特性)
.feature-icon-card {
  padding: 2rem 1.5rem;
  text-align: center;
  // transition: transform 0.3s ease, box-shadow 0.3s ease; // Replaced by mixin
  border-radius: $border-radius-xl;
  background: white;
  position: relative; // For pseudo-element positioning
  z-index: 1;
  overflow: hidden;
  // will-change: transform; // Handled by mixin
  contain: content; // Performance optimization for layout boundaries
  transition: background-color $transition-base, color $transition-base; // Add transition for text color change

  &::before {
    // Background gradient revealed on hover
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: linear-gradient(135deg, $primary 0%, $dark 100%);
    opacity: 0;
    z-index: -1; // Behind content
    transition: opacity 0.3s ease;
  }

  // Apply hover effect with moderate intensity
  @include card-hover-effect('moderate');

  &:hover {
    // Additional hover styles specific to this card type
    &::before {
      opacity: 1; // Show gradient background
    }

    .card-title,
    .card-text,
    i {
      color: white !important; // Change text and icon color
    }

    .btn-outline-primary {
      // Invert button colors on hover
      background-color: white;
      color: $primary;
      border-color: white;
    }
  }

  i {
    // Icon styling
    font-size: 3rem;
    margin-bottom: 1.5rem;
    color: $primary;
    transition: color $transition-base; // Transition color change
  }

  .card-title {
    // Card title styling
    font-weight: $font-weight-bold;
    margin-bottom: 1rem;
    transition: color $transition-base; // Transition color change
  }

  .card-text {
    // Card text styling
    font-size: 0.95rem;
    margin-bottom: 1.5rem;
    transition: color $transition-base; // Transition color change
  }

  .btn {
    // Button styling within the card
    border-radius: $border-radius-pill;
    padding: 0.5rem 1.5rem;
    transition: background-color $transition-base, color $transition-base, border-color $transition-base;
  }
}

// 特色内容卡片 (通常带图片和摘要)
.feature-card {
  height: 100%; // Ensure consistent height in grids
  display: flex;
  flex-direction: column;
  border-radius: $border-radius-xl;
  overflow: hidden;
  box-shadow: $box-shadow;
  transition: box-shadow $transition-slow, transform $transition-slow; // Combine transitions

  @include image-scale-hover(1.05, 0.8s); // Apply image scale hover with more subtle effect
  @include card-hover-effect('moderate'); // Apply moderate hover effect

  .card-img-top {
    height: 200px;
    object-fit: cover;
    // transition handled by mixin
  }

  // &:hover .card-img-top { // Replaced by mixin
  //   transform: scale(1.08);
  // }

  .card-body {
    // Ensure body takes remaining space
    flex: 1;
  }

  .card-title {
    // Title styling
    font-weight: $font-weight-bold;
    color: $dark;
    margin-bottom: 1rem;
  }

  .card-footer {
    // Footer specific styles
    background: transparent;
    padding-top: 0; // Adjust padding if needed
  }

  .badge {
    // Badge styling within the card
    padding: 0.5em 1em;
    font-weight: $font-weight-medium;
    letter-spacing: 0.5px;
  }
}

// 内容卡片列表项 (用于文章、项目等列表)
.content-card {
  border-radius: $border-radius-xl;
  overflow: hidden;
  box-shadow: $box-shadow;
  // transition: $transition-slow; // Replaced by mixin
  margin-bottom: 1.5rem; // Spacing between cards

  @include card-hover-effect('moderate'); // Apply moderate hover effect
  @include image-scale-hover(1.03, 0.8s); // Apply more subtle image scale hover

  // &:hover { // Replaced by mixin
  //   transform: translateY(-10px);
  //   box-shadow: $box-shadow-xl;
  // }

  .card-img-top {
    height: 180px;
    object-fit: cover;
    // transition handled by mixin
  }

  // &:hover .card-img-top { // Replaced by mixin
  //   transform: scale(1.05);
  // }

  .card-body {
    // Body styling
    padding: 1.25rem;
  }

  .card-title {
    // Title styling with ellipsis for overflow
    font-weight: $font-weight-bold;
    font-size: 1.1rem;
    margin-bottom: 0.75rem;
    white-space: nowrap; // Prevent wrapping
    overflow: hidden; // Hide overflow
    text-overflow: ellipsis; // Show ellipsis (...)
  }

  .card-footer {
    // Footer styling
    padding: 1rem 1.25rem;
    background: transparent;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
  }
}

// 视频卡片 (带播放按钮覆盖)
.video-card {
  position: relative; // For absolute positioning of overlay/icon
  overflow: hidden;
  border-radius: $border-radius-lg; // Add border-radius consistent with other cards

  &::after {
    // Gradient overlay for better text visibility
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: linear-gradient(to bottom, transparent 50%, rgba(0, 0, 0, 0.5));
    z-index: 1; // Above image, below icon
  }

  .play-icon {
    // Play button icon
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 3rem;
    z-index: 2; // Above overlay
    opacity: 0.8;
    transition: transform $transition-base, opacity $transition-base;
    will-change: transform, opacity;
  }

  &:hover .play-icon {
    // Scale up icon on hover
    transform: translate(-50%, -50%) scale(1.2);
    opacity: 1;
  }
}

// 统计卡片 (显示数字和标签)
.stats-card {
  border-radius: $border-radius;
  padding: 1.5rem;
  text-align: center;
  // transition: $transition-base; // Replaced by mixin
  height: 100%; // Ensure consistent height
  box-shadow: $box-shadow;
  @include card-hover-effect('subtle'); // Apply subtle hover effect

  // &:hover { // Replaced by mixin
  //   transform: translateY(-5px);
  //   box-shadow: $box-shadow-lg;
  // }

  i {
    // Icon styling
    font-size: 2.5rem;
    margin-bottom: 1rem;
    opacity: 0.8;
  }

  h3 {
    // Main statistic number
    font-size: 2rem;
    margin-bottom: 0.5rem;
    font-weight: $font-weight-bold;
  }

  p {
    // Label or description for the statistic
    margin-bottom: 0;
    font-size: 1rem;
    opacity: 0.9;
  }
}

// 媒体网格中的卡片 (通常用于图片库)
.media-grid .card {
  border: none; // Reset border if needed within grid context
  border-radius: $border-radius-lg;
  overflow: hidden;
  // transition: $transition-slow; // Replaced by mixins

  @include card-hover-effect('moderate'); // Apply moderate hover effect
  @include image-scale-hover(1.05, 0.6s); // Apply more subtle image scale hover

  // &:hover { // Replaced by mixin
  //   transform: translateY(-10px);
  //   box-shadow: $box-shadow-xl;
  // }

  .card-img-top {
    height: 200px;
    object-fit: cover;
    // transition handled by mixin
  }

  // &:hover .card-img-top { // Replaced by mixin
  //   transform: scale(1.1);
  // }
}

// --- 响应式调整 ---
// 使用通用响应式模式
@include pattern.responsive-card-pattern;
